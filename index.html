<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PASSPORT AUTH</title>
</head>

<body>
  <button id="btnLogin">Login</button>
  <button id="btnLogout">Logout</button>

  <p id="lblAccount"></p>
  <p id="lblEmail"></p>
  <script type="module">
    import {
      login, logout, userInfo, getToken
    } from './dist/passport.js';
    const btnLogin = document.getElementById('btnLogin');
    const btnLogout = document.getElementById('btnLogout');
    const btnToken = document.getElementById('btnToken');
    const lblAccount = document.getElementById('lblAccount');
    const lblEmail = document.getElementById('lblEmail');

    btnLogin.addEventListener('click', async () => {
      await loadInfo();
    });

    btnLogout.addEventListener('click', async () => {
      await logout();
    });

    if (await getToken()) {
      await loadInfo();
    }
    
    async function loadInfo() {
      const accounts = await login();
      const info = await userInfo();

      if (accounts.length > 0) {
        lblAccount.innerText = accounts[0];
        if (info) {
          lblEmail.innerText = info.email;
        }
      }
    }

  </script>
</body>

</html>